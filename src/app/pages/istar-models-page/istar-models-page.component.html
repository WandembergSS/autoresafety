<section class="page">
  <header class="page__header">
    <p class="step">Step 2</p>
    <h2>Define the iStar4Safety Models</h2>
    <p>
      Extend the SafeSecIoT Canvas into Strategic Dependency and Strategic Rationale views. Use these mock tables to align
      actors, responsibilities, and &lt;&lt;SafetyGoal&gt;&gt; elements before transitioning into the STPA control structure.
    </p>
  </header>

  <div class="grid">
    <section class="card">
      <div class="card__header">
        <h3>Actor roster</h3>
        <form class="inline-form" [formGroup]="actorForm" (ngSubmit)="addActor()">
          <input type="text" placeholder="Actor name" formControlName="name" />
          <select formControlName="type">
            <option value="Controller">Controller</option>
            <option value="Sensor">Sensor</option>
            <option value="Environment">Environment</option>
            <option value="Stakeholder">Stakeholder</option>
          </select>
          <input type="text" placeholder="Primary responsibility" formControlName="responsibility" />
          <button type="submit">Add actor</button>
        </form>
      </div>

      <div class="actor-table">
        @for (actor of actors(); track actor.id) {
          <article class="actor-card">
            <header>
              <h4>{{ actor.name }}</h4>
              <span class="badge badge--{{ actor.type | lowercase }}">{{ actor.type }}</span>
            </header>
            <ul>
              @for (responsibility of actor.responsibilities; track responsibility) {
                <li>{{ responsibility }}</li>
              }
            </ul>
          </article>
        }
      </div>
    </section>

    <section class="card">
      <div class="card__header">
        <h3>Goal and hazard links</h3>
        <form class="inline-form" [formGroup]="goalForm" (ngSubmit)="addGoalLink()">
          <input type="text" placeholder="Actor" formControlName="fromActor" />
          <input type="text" placeholder="Goal or hazard statement" formControlName="goal" />
          <select formControlName="linkType">
            <option value="achieves">Achieves</option>
            <option value="depends-on">Depends on</option>
            <option value="obstructs">Obstructs</option>
            <option value="satisfies">Satisfies</option>
          </select>
          <button type="submit">Add link</button>
        </form>
      </div>

      <table class="table">
        <thead>
          <tr>
            <th>Actor</th>
            <th>Goal / Hazard</th>
            <th>Link</th>
          </tr>
        </thead>
        <tbody>
          @for (link of goalLinks(); track link.id) {
            <tr>
              <td>{{ link.fromActor }}</td>
              <td>{{ link.goal }}</td>
              <td><span class="badge badge--link">{{ link.linkType }}</span></td>
            </tr>
          }
        </tbody>
      </table>
    </section>
  </div>

  <section class="card card--note">
    <h3>Visual modeller placeholder</h3>
    <p>
      In the functional product, this area would host an interactive canvas for iStar diagrams. For now, it provides a textual
      summary and a mock legend describing how elements map to safety concepts.
    </p>
    <div class="legend">
      <div>
        <strong>Legend</strong>
        <ul>
          <li><span class="chip chip--goal"></span> Safety Goal</li>
          <li><span class="chip chip--hazard"></span> Hazard / Obstruction</li>
          <li><span class="chip chip--task"></span> Safety Task</li>
        </ul>
      </div>
      <div>
        <strong>Traceability snippet</strong>
        <p>
          Controller <em>Infusion Controller</em> <strong>achieves</strong> goal <em>Maintain basal delivery</em> and <strong>depends on</strong>
          <em>Human Caregiver</em> for <em>Regimen approval</em>. Hazard <em>Over-infusion</em> obstructs this goal and is mitigated by safety task
          <em>Dual configuration approval</em>.
        </p>
      </div>
    </div>
  </section>
</section>
